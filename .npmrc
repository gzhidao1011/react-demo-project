# ------------------------------
# Core Workspace Behavior
# ------------------------------

# 优先使用本地工作区包，而不是从 npm registry 下载
prefer-workspace-packages = true

# 使用符号链接（symlink）连接工作区包，而不是复制
link-workspace-packages = true

# 使用单一锁文件（`pnpm-lock.yaml`）管理整个 monorepo
shared-workspace-lockfile = true

# 添加工作区包时自动使用 `workspace:` 协议
save-workspace-protocol = true


# ------------------------------
# Dependency Resolution
# ------------------------------

# 选择最高兼容版本，减少版本碎片化
resolution-mode = highest

# 自动安装 peer dependencies（对等依赖）
auto-install-peers = true

# 不强制要求 peer dependencies 必须安装
strict-peer-dependencies = false


# ------------------------------
# Performance Optimizations
# ------------------------------

# 使用缓存加速原生模块（如 sharp、esbuild）的构建
side-effects-cache = true

# 优先使用本地缓存，减少网络请求
prefer-offline = true

# 在 CI 中拒绝修改锁文件（防止版本漂移）
prefer-frozen-lockfile = true

# 使用隔离链接器（与 Node 生态系统工具的最佳兼容性）
node-linker = isolated

# 将常用工具提升到根目录，防止重复并加速解析
public-hoist-pattern[] = typescript
public-hoist-pattern[] = eslint
public-hoist-pattern[] = *@plane/*
public-hoist-pattern[] = vite
public-hoist-pattern[] = turbo