# Docker 环境配置
server:
  port: 8080

spring:
  application:
    name: api-gateway
  cloud:
    gateway:
      httpclient:
        connect-timeout: 5000
        response-timeout: 30s
      routes:
        # 用户服务路由
        - id: user-service
          uri: lb://user-service
          predicates:
            - Path=/api/users/**
        
        # 订单服务路由
        - id: order-service
          uri: lb://order-service
          predicates:
            - Path=/api/orders/**
        
        # ✅ 认证相关路由
        - id: auth-service
          uri: lb://user-service
          predicates:
            - Path=/api/auth/**
    
    nacos:
      discovery:
        server-addr: ${NACOS_SERVER_ADDR:nacos:8848}
        namespace: ${NACOS_NAMESPACE:public}
        group: ${NACOS_GROUP:DEFAULT_GROUP}
    
    # Sentinel 配置
    sentinel:
      transport:
        port: 8719
        dashboard: ${SENTINEL_DASHBOARD:sentinel:8858}
      eager: true
      scg:
        fallback:
          mode: response
          response-status: 429
          response-body: '{"code": 429, "message": "请求过于频繁，请稍后再试", "success": false}'
          content-type: application/json;charset=UTF-8

# 健康检查配置
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

# 日志配置
logging:
  level:
    root: INFO
    org.springframework.cloud.gateway: INFO
